function e({action:e},{env:a,logger:t}){const s={information_general:"/items/information_general",page_accueil:"/items/page_accueil",page_la_meute:"page_la_meute",page_spectacles:"/items/page_spectacles",page_agenda:"/items/page_agenda",page_galerie:"/items/page_galerie",page_contact:"/items/page_contact",nos_spectacles:"/items/nos_spectacles",date_de_spectacles:"/items/date_de_spectacles",les_artistes:"/items/les_artistes"},c=["items.create","items.update","items.delete"],i=process.env.NEXT_CACHE_SECRET??fs.readFileSync("/run/secrets/LESDEMUSELEES-UAT-NEXT_CACHE_SECRET","utf8").trim(),r=async e=>{try{console.log(`[CACHE] Purge de la clé "${e}" ${a.NEXTJS_URL}/api/clear-cache`);const s=await fetch(`${a.NEXTJS_URL}/api/clear-cache`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({key:e})}),c=await s.json();s.ok?t.info(`[CACHE] Clé "${e}" purgée avec succès`):t.warn(`[CACHE] Échec purge clé "${e}" : ${c.message}`)}catch(a){t.error(`[CACHE] Erreur lors de la purge "${e}" : ${a.message}`)}};for(const a of c)e(a,(async({collection:e})=>{const a=s[e];a&&await r(a)}))}export{e as default};
